<div class="page-header">
  <div class="header-content p-4">
    <h5><span class="text-uppercase text-primary-custom">Dashboard</span> <span class="mx-3 text-muted">|</span> Solidaridad's IVR platform lets you bridge language, literacy, and distance barriers using the power of mobile communication.</h5>
  </div>
</div>

<div class="page-content">
  <div class="row">
    <div class="col-sm-12 col-md-6 col-lg-4">
      <div class="card border shadow-sm fixed-card-height mb-3" *blockUI="'subs'">
        <div class="card-body">
          <div class="card-title text-muted font-12 font-weight-bold">Subscriber Summary</div>
          <ng-container *ngIf="subscriberSummary$ | async as summary">
            <div class="text-muted font-11">
              <span>Total Number of Subscribers</span>
              <span class="float-right">{{summary.total}}</span>
            </div>
            <div class="progress progress-height mb-3">
              <div class="progress-bar bg-primary" role="progressbar" style="width: 100%" aria-valuenow="100"
                aria-valuemin="0" aria-valuemax="100">100%</div>
            </div>

            <div class="text-muted font-11">
              <span>Active Number of Subscribers</span>
              <span class="float-right">{{summary.active}}</span>
            </div>
            <div class="progress progress-height mb-3">
              <div class="progress-bar bg-info" role="progressbar" [style.width.%]="summary.activePercentage"
                aria-valuemin="0" aria-valuemax="100">{{summary.activePercentage}}%</div>
            </div>

            <ng-container *ngFor="let record of summary.percentageSummary">
              <div class="text-muted font-11">
                <span>{{record.name}}</span>
                <span class="float-right">{{record.count}}</span>
              </div>
              <div class="progress progress-height mb-3">
                <div class="progress-bar" role="progressbar" [ngClass]="setProgressColor(record.percentage)"
                  [style.width.%]="record.percentage" aria-valuemin="0" aria-valuemax="100">{{record.percentage}}%</div>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </div>
    </div>

    <div class="col-sm-12 col-md-6 col-lg-4">
      <div class="card border shadow-sm fixed-card-height mb-3" *blockUI="'type'">
        <div class="card-body">
          <div class="card-title text-muted">
            <div class="form-group mb-4">
              <div class="row">
                <div class="col-sm-6">
                    <label class=" font-12 font-weight-bold">Subscriber Type Summary</label>
                </div>
                <div class="col-sm-6">
                  <!-- <div class="col-sm-12 col-md-6"> -->
                    <ng-select [items]="subscriberTypes$ | async" bindLabel="name" bindValue="id"
                    placeholder="Select Subscriber Type" [clearable]="false" [loading]="loadingSubscriberTypes"
                    [(ngModel)]="subscriberTypeId" (ngModelChange)="subscriberTypeOnChange()" class="form-control-sm">
                  </ng-select>
                  <!-- </div> -->
                </div>
              </div>
              
            </div>
          </div>

          <ng-container *ngIf="subscriberTypeSummary$ | async as summary">
            <div class="row">
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Number of Male Subscribers</div>
                <!-- <div class="text-muted font-11">Count</div> -->
                <div class="h5 text-secondary ml-2">{{summary.maleSubscribers | number}}</div>
              </div>
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Number of Female Subscribers</div>
                <div class="h5 text-secondary ml-2">{{summary.femaleSubscribers | number}}</div>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Average Age of Male Subscribers</div>
                <div class="h5 text-secondary ml-2">{{summary.averageMaleAge | number:'1.0-2'}}</div>
              </div>
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Average Age of Female Subscribers</div>
                <div class="h5 text-secondary ml-2">{{summary.averageFemaleAge | number:'1.0-2'}}</div>
              </div>
            </div>

            <div class="row">
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Average Land Area</div>
                <div class="h5 text-secondary">{{summary.averageMaleLandArea | number:'1.0-2'}} Hectares</div>
              </div>
              <div class="col-6">
                <div class="font-11 text-muted mb-1">Average Land Area</div>
                <div class="h5 text-secondary">{{summary.averageFemaleLandArea | number:'1.0-2'}} Hectares</div>
              </div>
            </div>
          </ng-container>
        </div>
      </div>
    </div>

    <div class="col-sm-12 col-md-6 col-lg-4">
      <div class="card border shadow-sm fixed-card-height mb-3" *blockUI="'commodity'">
        <div class="card-body">
          <div class="card-title text-muted font-12 font-weight-bold">Subscriber Commodity Summary</div>
          <div class="chart-container" *ngIf="pie">
            <canvas class="m-auto" #piecanvas>{{ pie }}</canvas>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-sm-12 col-md-4">
      <div class="card border shadow-sm fixed-card-height mb-3" *blockUI="'land'">
        <div class="card-body">
          <div class="card-title text-muted font-12 font-weight-bold">Land Size Summary</div>
          <div class="chart-container" *ngIf="doughnut">
            <canvas class="m-auto" #doughnutcanvas>{{ doughnut }}</canvas>
          </div>
        </div>
      </div>
    </div>

    <div class="col-sm-12 col-md-8">
      <div class="card border shadow-sm fixed-card-height mb-3" *blockUI="'campaign'">
        <div class="card-body">
          <div class="card-title text-muted font-12 font-weight-bold">Sustainability Status</div>
          <div class="form-inline mb-3 ml-3">
            <div class="input-group input-group-sm mr-2 mb-2">
              <div class="input-group-prepend">
                <div class="input-group-text">
                  Start Date
                </div>
              </div>
              <input type="date" class="form-control" name="startDate" [(ngModel)]="startDate">
            </div>
            <div class="input-group input-group-sm mr-2 mb-2">
              <div class="input-group-prepend">
                <div class="input-group-text">
                  End Date
                </div>
              </div>
              <input type="date" class="form-control" name="endDate" [(ngModel)]="endDate">
            </div>
            <button type="button" class="btn btn-primary btn-sm mb-2" (click)="getCampaignSummary(startDate, endDate)">Submit</button>
          </div>
          
          <div class="row" *ngIf="susStatus$ | async as sus">
            <div class="col-sm-3 text-center text-muted">
              <i class="fa fa-dot-circle-o fa-lg text-dark-golder-rod"></i>&nbsp; Total Campaigns <br>
              <h4>{{sus.total}}</h4>
            </div>
            <div class="col-sm-3 text-center text-muted">
              <i class="fa fa-dot-circle-o fa-lg text-dark-golder-rod"></i>&nbsp; Active Campaigns <br>
              <h4>{{sus.active}}</h4>
            </div>
            <div class="col-sm-3 text-center text-muted">
              <i class="fa fa-dot-circle-o fa-lg text-dark-golder-rod"></i>&nbsp; Total Schedules <br>
              <h4>{{sus.totalSchedules}}</h4>
            </div>
            <div class="col-sm-3 text-center text-muted">
              <i class="fa fa-dot-circle-o fa-lg text-dark-golder-rod"></i>&nbsp; Active Schedules <br>
              <h4>{{sus.activeSchedules}}</h4>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>